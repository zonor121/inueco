# **Практическое задание: Анализ продаж интернет-магазина**

## **Цель задания**

Закрепить все изученные темы по Series pandas на практике, выполнив полный анализ данных о продажах.

## **Исходные данные**

У вас есть данные о продажах интернет-магазина за последний месяц:

```python
import pandas as pd
import numpy as np

# Данные о продуктах
product_ids = [101, 102, 103, 104, 105, 106, 107, 108, 109, 110]
product_names = [
    'Ноутбук Dell XPS 13',
    'Смартфон iPhone 15',
    'Наушники Sony WH-1000XM5',
    'Планшет iPad Air',
    'Умные часы Apple Watch',
    'Фотоаппарат Canon EOS R6',
    'Игровая консоль PlayStation 5',
    'Телевизор Samsung QLED',
    'Кофемашина DeLonghi',
    'Робот-пылесос iRobot'
]
categories = ['Электроника', 'Электроника', 'Аксессуары', 'Электроника', 'Аксессуары',
              'Электроника', 'Развлечения', 'Электроника', 'Бытовая техника', 'Бытовая техника']

# Данные о продажах
units_sold = [45, 120, 85, 60, 90, 25, 70, 35, 40, 55]
unit_prices = [899.99, 999.99, 349.99, 749.99, 399.99, 2499.99, 499.99, 1299.99, 599.99, 449.99]
discounts = [0.10, 0.05, 0.15, 0.00, 0.20, 0.08, 0.12, 0.05, 0.10, 0.07]
return_rates = [0.02, 0.01, 0.03, 0.01, 0.04, 0.02, 0.05, 0.01, 0.03, 0.02]

# Создайте Series для каждого набора данных
products = pd.Series(product_names, index=product_ids, name='Продукт')
category_series = pd.Series(categories, index=product_ids, name='Категория')
units = pd.Series(units_sold, index=product_ids, name='Продано_шт')
prices = pd.Series(unit_prices, index=product_ids, name='Цена_за_шт')
discount_series = pd.Series(discounts, index=product_ids, name='Скидка')
returns = pd.Series(return_rates, index=product_ids, name='Процент_возвратов')
```

## **Часть 1: Создание и базовый анализ**

### **Задача 1.1: Изучение структуры Series**

```python
# 1. Создайте Series для каждого набора данных (уже создано выше)
# 2. Выведите информацию о каждой Series: тип, размер, индекс
# 3. Проверьте, есть ли пропущенные значения в каждой Series
```

### **Задача 1.2: Работа с индексами**

```python
# 1. Переименуйте индексы, добавив префикс 'P_' (например, P_101 вместо 101)
# 2. Отсортируйте Series 'products' по алфавиту названий продуктов
# 3. Отсортируйте Series 'prices' по убыванию цен
```

### **Задача 1.3: Доступ к данным**

```python
# 1. Получите цену продукта с ID 103 (тремя способами)
# 2. Получите продукты с ID 101, 104, 107
# 3. Получите последние 3 продукта по позиции
# 4. Получите все продукты дороже 1000 единиц
```

## **Часть 2: Векторные операции**

### **Задача 2.1: Расчет выручки**

```python
# 1. Рассчитайте выручку от каждого продукта (продано_шт * цена_за_шт)
# 2. Учтите скидки: выручка_со_скидкой = выручка * (1 - скидка)
# 3. Рассчитайте чистую выручку (за вычетом возвратов)
```

### **Задача 2.2: Цепочка операций**

```python
# 1. Создайте Series с итоговой ценой после скидки для каждого продукта
# 2. Рассчитайте общее количество проданных единиц по категориям
# 3. Рассчитайте среднюю цену продукта в каждой категории
```

## **Часть 3: Логические операции и фильтрация**

### **Задача 3.1: Фильтрация продуктов**

```python
# 1. Найдите все продукты категории "Электроника"
# 2. Найдите продукты, которые продались более 50 штук
# 3. Найдите продукты с ценой от 500 до 1000 единиц
# 4. Найдите продукты с высокой скидкой (>10%) и низким процентом возвратов (<3%)
```

### **Задача 3.2: Категоризация**

```python
# 1. Создайте категорию продуктов по цене:
#    - Бюджетные: < 500
#    - Средние: 500-1000
#    - Премиум: > 1000
# 2. Создайте категорию по популярности (продано_шт):
#    - Хиты: > 100
#    - Популярные: 50-100
#    - Обычные: < 50
```

## **Часть 4: Работа с пропущенными значениями**

### **Задача 4.1: Моделирование реальных данных**

```python
# Добавьте пропуски в данные (имитация реальной ситуации)
np.random.seed(42)
prices_with_nan = prices.copy()
prices_with_nan.iloc[[2, 5, 8]] = np.nan

units_with_nan = units.copy()
units_with_nan.iloc[[1, 4, 7]] = np.nan
```

### **Задача 4.2: Обработка пропусков**

```python
# 1. Определите количество пропусков в каждой Series
# 2. Заполните пропуски в ценах медианной ценой по категории
# 3. Заполните пропуски в количестве продаж нулями
# 4. Сравните статистику до и после заполнения пропусков
```

## **Часть 5: Преобразование значений**

### **Задача 5.1: Форматирование данных**

```python
# 1. Приведите все названия продуктов к нижнему регистру
# 2. Удалите лишние пробелы в названиях продуктов
# 3. Преобразуйте цены в целые числа (округлите)
# 4. Преобразуйте проценты скидок в проценты с точностью до 2 знаков
```

### **Задача 5.2: Создание новых признаков**

```python
# 1. Создайте Series с общей выручкой от каждого продукта
# 2. Создайте Series с маржинальностью (разница между ценой и себестоимостью)
#    (предположим, себестоимость = цена * 0.6)
# 3. Создайте Series с рентабельностью (прибыль / выручка)
```

## **Часть 6: Статистический анализ**

### **Задача 6.1: Описательная статистика**

```python
# 1. Рассчитайте основные статистики для цен и количества продаж
# 2. Найдите квартили для выручки
# 3. Рассчитайте стандартное отклонение и коэффициент вариации для цен
# 4. Постройте распределение продуктов по категориям
```

### **Задача 6.2: Нормализация и ранжирование**

```python
# 1. Нормализуйте цены (минимаксная нормализация)
# 2. Стандартизируйте количество продаж (Z-нормализация)
# 3. Проранжируйте продукты по выручке (от самого прибыльного к самому убыточному)
# 4. Рассчитайте накопленную выручку
```

## **Часть 7: Series как основа DataFrame**

### **Задача 7.1: Создание DataFrame**

```python
# 1. Создайте DataFrame из всех Series
# 2. Добавьте вычисляемые столбцы (выручка, прибыль и т.д.)
# 3. Извлеките отдельные столбцы обратно в Series и выполните операции
```

### **Задача 7.2: Комплексный анализ**

```python
# 1. С помощью цепочки методов (method chaining):
#    - Отфильтруйте продукты категории "Электроника"
#    - Рассчитайте для них среднюю цену и общую выручку
#    - Отсортируйте по убыванию выручки
#    - Выведите топ-3 продукта
```

## **Часть 8: Итоговый отчет**

### **Задача 8.1: Сводный анализ**

```python
# 1. Какие 3 продукта принесли наибольшую выручку?
# 2. Какая категория самая прибыльная?
# 3. Как скидки влияют на количество продаж?
# 4. Есть ли корреляция между ценой и процентом возвратов?
```

### **Задача 8.2: Рекомендации**

```python
# На основе анализа предложите:
# 1. На какие продукты увеличить скидки?
# 2. Какие продукты стоит снять с продажи?
# 3. Как оптимизировать ассортимент?
```

## **Дополнительные задачи для продвинутых:**

1. **Анализ временных трендов** — добавьте Series с датами продаж
2. **Прогнозирование** — используйте скользящее среднее для прогноза продаж
3. **Кластеризация** — разделите продукты на группы по цене и популярности
4. **A/B тестирование** — смоделируйте изменение цены и оцените влияние на продажи

## **Подсказки:**

- Используйте метод `.copy()` при работе с данными, которые нужно изменять
- Помните про выравнивание по индексам при операциях между Series
- Используйте `.loc` и `.iloc` для доступа к данным
- Применяйте векторные операции вместо циклов
- Проверяйте наличие пропусков перед анализом
